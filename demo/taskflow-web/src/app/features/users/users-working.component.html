<div class="users-container">
  <div class="page-header">
    <h1>
      <mat-icon class="header-icon">people</mat-icon>
      User Profiles
    </h1>
    <p class="subtitle">
      Manage and view all user profiles in the system (Demo Mode)
    </p>
  </div>

  @if (userContext.isLoading()) {
    <div class="loading-container">
      <mat-spinner></mat-spinner>
      <p>Loading user profiles...</p>
    </div>
  } @else {
    <mat-card class="users-card">
      <mat-card-header>
        <mat-card-title>All Users ({{ userContext.allProfiles().length }})</mat-card-title>
        <mat-card-subtitle>
          Current user:
          <strong>{{ userContext.currentUser()?.displayName || 'None' }}</strong>
        </mat-card-subtitle>
      </mat-card-header>

      <mat-card-content>
        <table mat-table [dataSource]="userContext.allProfiles()" class="users-table">
          <!-- Name Column -->
          <ng-container matColumnDef="displayName">
            <th mat-header-cell *matHeaderCellDef>Name</th>
            <td mat-cell *matCellDef="let user">
              <div class="user-name-cell">
                <mat-icon class="user-avatar">account_circle</mat-icon>
                <span>{{ user.displayName }}</span>
                @if (user.userId === currentUserId()) {
                  <mat-chip>You</mat-chip>
                }
              </div>
            </td>
          </ng-container>

          <!-- Email Column -->
          <ng-container matColumnDef="email">
            <th mat-header-cell *matHeaderCellDef>Email</th>
            <td mat-cell *matCellDef="let user">{{ user.email }}</td>
          </ng-container>

          <!-- Role Column -->
          <ng-container matColumnDef="role">
            <th mat-header-cell *matHeaderCellDef>Role</th>
            <td mat-cell *matCellDef="let user">
              @if (isAdmin(user)) {
                <mat-chip highlighted>
                  <mat-icon>admin_panel_settings</mat-icon>
                  Admin
                </mat-chip>
              } @else {
                <mat-chip>User</mat-chip>
              }
            </td>
          </ng-container>

          <!-- Created Column -->
          <ng-container matColumnDef="createdAt">
            <th mat-header-cell *matHeaderCellDef>Created</th>
            <td mat-cell *matCellDef="let user">
              {{ formatDate(user.createdAt) }}
            </td>
          </ng-container>

          <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
          <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
        </table>
      </mat-card-content>
    </mat-card>
  }
</div>
